# **Игровые события**

После создания игры игровые события становятся главным форматом передачи данных между сервером и клиентами. Клиент может быть соединён с сервером двумя способами:

- ### **REST API**.
Для совершения игровых действий клиент может посылать POST-запросы с **Событиями Игрока**, и отслеживать изменение состояния игры с помощью GET-запроса [Get Game](/docs/rest/#/default/game__game_id__get).

- ### **Websocket**.
Клиент создаёт вебсокет-соединение с сервером и может совершать игровые действия, отсылая **События Игрока**, и отслеживать изменения игры, получая события от сервера и других клиентов.

!!! info "Определение типа события"
    У любого событие есть поле `type`, в котором хранится его тип. Зная тип можно понять, какие
    поля есть у события и какие значения в них могут быть.

## Цели (Event Targets) { #targets }

Для того, чтобы понять, кому предназначается событие, существует поле ```targets```.
Вне зависимости от того, кому предназначено событие, оно посылается на сервер, где будет обработано и
переслано необходимым клиентам.

| Значение `targets`      | Кому предназначено     |
| :---------------------- | --------               |
| '"All"'                 | Для всех клиентов      |
| '"Server"'              | Только для сервера     |
| Список с ```player_id```| Для указанных клиентов |

Если событие является [Observable](#Observable), то событие *всегда будет пересылаться всем клиентам*.
В этом случае с помощью `targets` сервер определяет, какие клиенты получают полное событие.
Остальные клиенты получают событие с сокрытой информацией.


***


## Наблюдаемые события (Observable) { #Observable }

!!! abstract "Событие, часть информации которого может быть недоступна в зависимости от игрока"

Некоторые события содержат информацию, которая не должна быть доступна всем игрокам, например какой
припас получил Боцман при раздаче, или какую карту Шкет украл у Миледи. Но другие игроки всё ещё
должны знать, что событие произошло. В таком случае случае событие является **наблюдаемым**.

Всем игрокам, указанным в [`targets`](#targets), сервер пересылает неизменённое событие.
*Для всех остальных клиентов информация, которая должна быть сокрыта, заменяется на пустой объект `{}`*.

Для того, чтобы понять, в каком виде пришло наблюдаемое событие, в Observable существует поле
`observed`. `observed: true`, если событие содержит полную информацию и `observed: false`, если
часть информации скрыта.


## Направленные события (Targeted) { #Targeted }

!!! abstract "Событие, предназначенное только для одного игрока или только для сервера"


## События игрока (Player Events)

Эти события клиент отправляет для того, чтобы изменить состояние игры, например, закончить ход или запросить карту навигации. События отправляются на сервер, обрабатываются и пересылаются другим клиентам.

***

{%player_events%}


## События сервера (Game Events)

Эти события отправляются сервером и являются реакцией на посланные игровые события. Они отображают изменения, произошедшие в игре после того или иного игрового события. Например, смену фазы или список карт навигаций, предоставленных клиенту.

***

{%server_events%}